<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{default.html}">
<th:block layout:fragment="content">
    <div class="row">
        <h4>
            Подготовка к аттестации работников организаций по курсу:
        </h4>
    </div>
    <div class="row">
        <th:block
                th:replace="blocks/courses-list::courses-list(courses=${allCourses}, showControls=${false})"></th:block>
    </div>
    <div class="row">
        <div class="quote" style="width:505px; float:right">
            <span class="quote__icon"></span>
            <div class="quote__text">В наибольшей безопасности тот, кто начеку, даже когда нет опасности.</div>
            <div class="quote__autor">Сайрус Паблиус</div>
        </div>
    </div>
    <div class="row">
        <h5 th:text="${section.name}"></h5>
    </div>
    <div class="row edit-section-form" sec:authorize="${hasRole('ROLE_ADMIN')}">
        <form action="#" th:action="@{/section/{id}(id=${section.id})}" th:object="${newTest}"
              th:method="put">
            <input type="hidden" th:field="*{section.id}"/>

            <input type="hidden" th:field="*{id}"/>
            <div class="form-field">
                <label for="title">Название</label>
                <input id="title" type="text" class="form-control" th:field="*{title}"
                       style="width:100%"
                       th:classappend="${#fields.hasErrors('title')} ? 'is-invalid': 'is-valid'"
                       placeholder="Новый тест"/>
                <div class="invalid-feedback"
                     th:if="${#fields.hasErrors('title')}" th:errors="*{title}">
                    Title errors
                </div>
            </div>
            <div class="form-field">
                <label for="description">Описание</label>
                <textarea name="description" id="description" class="form-control" th:field="*{description}"
                          style="width: 100%;"
                          th:classappend="${#fields.hasErrors('description')} ? 'is-invalid': 'is-valid'"
                          placeholder="Новое описание"></textarea>
                <div class="invalid-feedback"
                     th:if="${#fields.hasErrors('description')}" th:errors="*{description}">
                    Description errors
                </div>
            </div>
            <button type="submit" style="margin:10px 0 0"
                    class="btn btn-primary ">+Добавить
            </button>
        </form>
    </div>
    <div class="row">
        <table class="table ">
            <thead>
            <tr>
                <th scope="col" style="width: 87px;">Наименование</th>
                <th scope="col" style="width: 500px;">Описание</th>
                <th:block sec:authorize="${hasRole('ROLE_ADMIN')}">
                    <th scope="col"></th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                </th:block>
            </tr>
            </thead>
            <tbody>
            <tr th:each="test, status : ${tests}" class="tests-list__item" th:attr="data-order=${test.order}, data-id=${test.id}">
                <td>
                    <a th:href="@{/tests/{id}(id=${test.id})}" th:text="${test.title}"></a>
                </td>
                <td th:text="${test.description}"></td>
                <th:block sec:authorize="${hasRole('ROLE_ADMIN')}">
                    <td>
                        <a href="javascript:void(0)" th:attr="data-src=@{/tests/{id}/edit-modal(id=${test.id})}"
                           data-fancybox data-type="ajax" >
                            <i class="sections-table__control far fa-edit" title="Редактировать"></i>
                        </a>
                    </td>
                    <td>
                        <a th:href="@{/section/{id}/delete(id=${section.id},deleteId=${test.id})}">
                            <i class="sections-table__control far fa-trash-alt" title="Удалить"></i>
                        </a>
                    </td>
                    <td>
                        <div class="sort-up btn-link">
                            Вверх
                        </div>
                        <div class="sort-down btn-link">
                            Вниз
                        </div>
                    </td>
                </th:block>
            </tr>
            </tbody>
        </table>
    </div>
</th:block>
</html>